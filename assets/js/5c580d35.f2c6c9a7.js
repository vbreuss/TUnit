"use strict";(self.webpackChunktunit_docs_site=self.webpackChunktunit_docs_site||[]).push([[3604],{4568:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>o,contentTitle:()=>n,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var a=l(4848),i=l(8453);const s={sidebar_position:11},n="Parallel Limiter",r={id:"tutorial-extras/parallel-limiter",title:"Parallel Limiter",description:"TUnit allows the user to control the parallel limit on a test, class or assembly level.",source:"@site/docs/tutorial-extras/parallel-limiter.md",sourceDirName:"tutorial-extras",slug:"/tutorial-extras/parallel-limiter",permalink:"/TUnit/docs/tutorial-extras/parallel-limiter",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"Ordering Tests",permalink:"/TUnit/docs/tutorial-extras/order"},next:{title:"Executors",permalink:"/TUnit/docs/tutorial-extras/executors"}},o={},d=[{value:"Example",id:"example",level:2},{value:"Caveats",id:"caveats",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"parallel-limiter",children:"Parallel Limiter"})}),"\n",(0,a.jsx)(t.p,{children:"TUnit allows the user to control the parallel limit on a test, class or assembly level."}),"\n",(0,a.jsxs)(t.p,{children:["To do this, we add a ",(0,a.jsx)(t.code,{children:"[ParallelLimiter<>]"})," attribute."]}),"\n",(0,a.jsxs)(t.p,{children:["You'll notice this has a generic type argument - You must give it a type that implements ",(0,a.jsx)(t.code,{children:"IParallelLimit"})," and has a public empty constructor. That interface requires you to define what the limit is for those tests."]}),"\n",(0,a.jsx)(t.p,{children:"If a class doesn't have a parallel limit defined, it'll try and eagerly run when the .NET thread pool allows it to do so."}),"\n",(0,a.jsxs)(t.p,{children:["If it does have a parallel limit defined, be aware that that parallel limit is shared for any tests with that same ",(0,a.jsx)(t.code,{children:"Type"})," of parallel limit."]}),"\n",(0,a.jsxs)(t.p,{children:["In the example below, ",(0,a.jsx)(t.code,{children:"MyParallelLimit"})," has a limit of ",(0,a.jsx)(t.code,{children:"2"}),". Now any test, anywhere in your test suite, that has this parallel limit attribute applied to it, will only be processed 2 at a time."]}),"\n",(0,a.jsx)(t.p,{children:"Other tests without this attribute may run alongside them still."}),"\n",(0,a.jsxs)(t.p,{children:["And other tests with a different ",(0,a.jsx)(t.code,{children:"Type"})," of parallel limit may also run alongside them still, but limited amongst themselves by their shared ",(0,a.jsx)(t.code,{children:"Type"})," and limit."]}),"\n",(0,a.jsxs)(t.p,{children:["So be aware that limits are only shared among tests with that same ",(0,a.jsx)(t.code,{children:"IParallelLimit"})," ",(0,a.jsx)(t.code,{children:"Type"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"So if you wanted to do a global limit on an assembly, you could do:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:"[assembly: ParallelLimiter<MyParallelLimit>]\n"})}),"\n",(0,a.jsx)(t.p,{children:"And as long as that isn't overridden on a test or class, then that will apply to all tests in an assembly and be shared among them all, limiting how many run in parallel."}),"\n",(0,a.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:"using TUnit.Core;\n\nnamespace MyTestProject;\n\n[ParallelLimiter<MyParallelLimit>]\npublic class MyTestClass\n{\n    [Test, Repeat(10)]\n    public async Task MyTest()\n    {\n        \n    }\n\n    [Test, Repeat(10)]\n    public async Task MyTest2()\n    {\n        \n    }\n}\n\npublic record MyParallelLimit : IParallelLimit\n{\n    public int Limit => 2;\n}\n"})}),"\n",(0,a.jsx)(t.h2,{id:"caveats",children:"Caveats"}),"\n",(0,a.jsxs)(t.p,{children:["If a test uses ",(0,a.jsx)(t.code,{children:"[DependsOn(nameof(OtherTest))]"})," and the other test has its own different parallel limit, this isn't guaranteed to be honoured."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,l)=>{l.d(t,{R:()=>n,x:()=>r});var a=l(6540);const i={},s=a.createContext(i);function n(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);